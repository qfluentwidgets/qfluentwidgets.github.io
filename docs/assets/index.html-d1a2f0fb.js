import{_ as o,r as e,o as c,c as p,b as s,d as n,a as i,e as a}from"./app-9cc97c28.js";const l={},u=a('<h2 id="设计原理" tabindex="-1"><a class="header-anchor" href="#设计原理" aria-hidden="true">#</a> 设计原理</h2><p><code>ConfigItem</code> 类表示一个配置项，配置类 <code>QConfig</code> 类用于读写配置项的值。当 <code>ConfigItem</code> 的值发生改变时会发送 <code>valueChanged(value: object)</code> 信号，<code>QConfig</code> 类也会自动将配置值同步到 json 配置文件中。</p><p>配置文件可能被用户篡改，导致配置项的值非法，所以 QFluentWidgets 使用 <code>ConfigValidator</code> 类及其子类来验证和修正配置项的值。</p><p>json 文件只支持字符串、布尔值、列表和字典，对于枚举类或者 <code>QColor</code>，无法直接将它们的值写入 json 文件中。为了解决这个问题，QFluentWidgets 提供了 <code>ConfigSerializer</code> 类及其子类来序列化和反序列化配置项。举个栗子，可以使用 <code>ColorSerializer</code> 来序列化值类型为 <code>QColor</code> 的配置项。</p>',4),d=s("code",null,"ConfigItem",-1),r={href:"https://pyqt-fluent-widgets.readthedocs.io/zh-cn/latest/autoapi/qfluentwidgets/common/config/index.html#qfluentwidgets.common.config.ConfigItem",target:"_blank",rel:"noopener noreferrer"},k=a(`<table><thead><tr><th>属性</th><th>数据类型</th><th>描述</th></tr></thead><tbody><tr><td><code>group</code></td><td><code>str</code></td><td>配置项所属的组别</td></tr><tr><td><code>name</code></td><td><code>str</code></td><td>配置项的名字</td></tr><tr><td><code>default</code></td><td><code>Any</code></td><td>配置项的默认值，当配置值非法时将被默认值替代</td></tr><tr><td><code>validator</code></td><td><code>ConfigValidator</code></td><td>配置校验器</td></tr><tr><td><code>serializer</code></td><td><code>ConfigSerializer</code></td><td>配置序列化器</td></tr><tr><td><code>restart</code></td><td><code>bool</code></td><td>配置更新后是否重启应用</td></tr></tbody></table><h2 id="使用方式" tabindex="-1"><a class="header-anchor" href="#使用方式" aria-hidden="true">#</a> 使用方式</h2><p>可通过下述步骤创建并使用自定义配置类 <code>MyConfig</code>：</p><ol><li>继承 <code>QConfig</code></li><li>将 <code>ConfigItem</code> 实例添加到 <code>MyConfig</code> 的类属性中</li><li>创建全局唯一的 <code>MyConfig</code> 单例 <code>cfg</code></li><li>调用 <code>qconfig.load(&quot;/path/to/config.json&quot;, cfg)</code> 加载配置文件</li><li>使用 <code>cfg.get(cfg.xxx)</code> 读取配置值，<code>cfg.set(cfg.xxx, value)</code> 写入配置值</li></ol><p>下面是一个简单的例子：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> enum <span class="token keyword">import</span> Enum

<span class="token keyword">from</span> qfluentwidgets <span class="token keyword">import</span> <span class="token operator">*</span>


<span class="token keyword">class</span> <span class="token class-name">MvQuality</span><span class="token punctuation">(</span>Enum<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot; MV quality enumeration class &quot;&quot;&quot;</span>

    FULL_HD <span class="token operator">=</span> <span class="token string">&quot;Full HD&quot;</span>
    HD <span class="token operator">=</span> <span class="token string">&quot;HD&quot;</span>
    SD <span class="token operator">=</span> <span class="token string">&quot;SD&quot;</span>
    LD <span class="token operator">=</span> <span class="token string">&quot;LD&quot;</span>

    <span class="token decorator annotation punctuation">@staticmethod</span>
    <span class="token keyword">def</span> <span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>q<span class="token punctuation">.</span>value <span class="token keyword">for</span> q <span class="token keyword">in</span> MvQuality<span class="token punctuation">]</span>


<span class="token keyword">class</span> <span class="token class-name">MyConfig</span><span class="token punctuation">(</span>QConfig<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot; Config of application &quot;&quot;&quot;</span>

    <span class="token comment"># main window</span>
    enableAcrylic <span class="token operator">=</span> ConfigItem<span class="token punctuation">(</span><span class="token string">&quot;MainWindow&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;EnableAcrylic&quot;</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> BoolValidator<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    playBarColor <span class="token operator">=</span> ColorConfigItem<span class="token punctuation">(</span><span class="token string">&quot;MainWindow&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;PlayBarColor&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#225C7F&quot;</span><span class="token punctuation">)</span>
    themeMode <span class="token operator">=</span> OptionsConfigItem<span class="token punctuation">(</span><span class="token string">&quot;MainWindow&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ThemeMode&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Light&quot;</span><span class="token punctuation">,</span> OptionsValidator<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;Light&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Dark&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Auto&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> restart<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    recentPlaysNumber <span class="token operator">=</span> RangeConfigItem<span class="token punctuation">(</span><span class="token string">&quot;MainWindow&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;RecentPlayNumbers&quot;</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> RangeValidator<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># online</span>
    onlineMvQuality <span class="token operator">=</span> OptionsConfigItem<span class="token punctuation">(</span><span class="token string">&quot;Online&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;MvQuality&quot;</span><span class="token punctuation">,</span> MvQuality<span class="token punctuation">.</span>FULL_HD<span class="token punctuation">,</span> OptionsValidator<span class="token punctuation">(</span>MvQuality<span class="token punctuation">)</span><span class="token punctuation">,</span> EnumSerializer<span class="token punctuation">(</span>MvQuality<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token comment"># 创建配置实例并使用配置文件来初始化它</span>
cfg <span class="token operator">=</span> MyConfig<span class="token punctuation">(</span><span class="token punctuation">)</span>
qconfig<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">&#39;config/config.json&#39;</span><span class="token punctuation">,</span> cfg<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,6);function v(m,g){const t=e("ExternalLinkIcon");return c(),p("div",null,[u,s("p",null,[d,n(" 的属性如下表所示，各个子类的构造函数见 "),s("a",r,[n("API 文档"),i(t)]),n("：")]),k])}const f=o(l,[["render",v],["__file","index.html.vue"]]);export{f as default};
